#------------------------------------SLIMMING GO IDS----------------------------
go_data = read.delim(file = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/QuickGO-annotations-1663870262043-20220922.tsv')
View(go_data)
go_data = go_data[ ,c(3,4)]
View(go_data)
sample_file = read.csv(file = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx')
View(sample_file)
#------------------------------------SLIMMING GO IDS----------------------------
go_data_cc = read.delim(file = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/QuickGO-annotations-1663870262043-20220922.tsv')
go_data_cc = go_data[ ,c(3,4)]
sample_file = read.csv(file = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx')
sample_file = openxlsx::read.xlsx(file = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx')
sample_file = openxlsx::read.xlsx(xlsxFile = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx')
View(sample_file)
View(sample_file)
sample_file = dplyr::filter(sample_file$source == 'GO:CC')
sample_file$source
sample_file$source == 'GO:CC'
sample_file = dplyr::filter(sample_file$source == 'GO:CC')
sample_file = dplyr::filter(sample_file, sample_file$source == 'GO:CC')
View(sample_file)
sample_file = openxlsx::read.xlsx(xlsxFile = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx') %>%
dplyr::filter(sample_file, sample_file$source == 'GO:CC')
sample_file = openxlsx::read.xlsx(xlsxFile = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx') %>%
dplyr::filter(sample_file, sample_file$source == 'GO:CC')
sample_file = sample_file[ , 14]
sample_file = openxlsx::read.xlsx(xlsxFile = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx')
sample_file = dplyr::filter(sample_file, sample_file$source == 'GO:CC')
View(sample_file)
sample_file = sample_file[ , c(9, 11, 14)]
View(sample_file)
View(go_data)
View(go_data_cc)
#------------------------------------SLIMMING GO IDS----------------------------
go_data_cc = read.delim(file = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/QuickGO-annotations-1663870262043-20220922.tsv')
go_data_cc = go_data[ ,c(3,4)]
go_data_cc = go_data_cc[ ,c(3,4)]
a = list()
a = append(list, c(1, 2, 3))
a
b = c(1, 2, 3)
c = c(4, 5, 6)
a = list
a[[b]]
a = a[[b]]
c(a, list(b))
a = c(a, list(b))
a
a = list()
a
a = c(a, as.list(b))
a
a = list()
a = append(a, list(b))
a = append(a, list(c))
a
sample_file[1]
View(sample_file)
i = 0
parent_go = sample_file[i, 3]
i = 1
parent_go = sample_file[i, 3]
for (x in parent_go) {print(x)}
parent_go = stringr::str_split(parent_go, ",")
View(parent_go)
parent_go
for (x in parent_go) {print(x)}
parent_go = stringr::str_split(parent_go, ",")[[1]]
parent_go
parent_go = sample_file[i, 3]
stringr::str_split(parent_go, ",")
stringr::str_split(parent_go, ",")[[1]]
parent_go = sample_file[i, 3]
parent_go = stringr::str_split(parent_go, ",")[[1]]
parent_go
parent_go = sample_file[i, 3]
parent_go = stringr::str_split(parent_go, ", ")[[1]]
parent_go
id = "GO:0005634"
View(go_data_cc)
id %in% go_data_cc$SLIMMED.FROM
sample_file = openxlsx::read.xlsx(xlsxFile = 'C:/Users/peree/OneDrive/Desktop/CompBio_Code/Cdc11_normal-0_ordered_enrichment.xlsx')
sample_file = dplyr::filter(sample_file, sample_file$source == 'GO:CC')
sample_file_subset = sample_file[ , c(9, 11, 14)]
for (i in 1:nrow(sample_file_subset)) {
parent_go = sample_file[i, 3]
parent_go = stringr::str_split(parent_go, ", ")[[1]]
for (id in parent_go) {
}
}
slimmed_list = list()
slimmed_list = append(slimmed_list, list(""))
slimmed_list
slimmed_list = list()
test_data = sample_file_subset
id
parent_go
i
i = 1
parent_go = sample_file_subset[i, 3]
parent_go = stringr::str_split(parent_go, ", ")[[1]]
parent_go
View(sample_file_subset)
id = "GO:0005634"
View(test_data)
test_data = go_data_cc
test_data = dplyr::filter(test_data, test_data$SLIMMED.FROM == id)
View(test_data)
test_data = unique(test_data)
View(test_data)
test_data = go_data_cc
test_data = dplyr::filter(test_data, test_data$SLIMMED.FROM == id)
View(test_data)
parent_go
id='GO:0032991'
test_data = go_data_cc
test_data = dplyr::filter(test_data, test_data$SLIMMED.FROM == id)
View(test_data)
test_data = go_data_cc
test_data = dplyr::filter(test_data, test_data$SLIMMED.FROM == 'GO:0110165')
View(test_data)
test_data = go_data_cc
test_data = dplyr::filter(test_data, test_data$SLIMMED.FROM == 'GO:0030880')
test_data = go_data_cc
test_data = dplyr::filter(test_data, test_data$SLIMMED.FROM == 'GO:0032991')
?unique
intersect(test_data$SLIMMED.FROM, sample_file_subset$parents)
?intersect
a = (1, 2, 3)
a = c(1, 2, 3)
b = c(3, 4, 5)
intersect(a, b)
intersect(test_data$SLIMMED.FROM, sample_file_subset$term_id)
intersect(test_data$GO.TERM, sample_file_subset$term_id)
intersect(test_data$GO.TERM, sample_file_subset$parents)
test_data$GO.TERM
intersect(go_data_cc$SLIMMED.FROM, sample_file_subset$parents)
intersect(go_data_cc$SLIMMED.FROM, sample_file_subset$term_id)
nrows(go_data_cc$SLIMMED.FROM)
nrow(go_data_cc$SLIMMED.FROM)
nrow(go_data_cc)
nrows(sample_file_subset)
nrow(sample_file_subset)
library(ActivePathways)
library(openxlsx)
library(dplyr)
library(gprofiler2)
library(ggplot2)
library(stringr)
library(clusterProfiler)
library(enrichplot)
library(DOSE)
library(naturalsort)
setwd("C:/Users/peree/OneDrive/Desktop/CompBio_Code/fun_enrich_files/per_marker_unordered")
DIRECTORY = "C:/Users/peree/OneDrive/Desktop/CompBio_Code/fun_enrich_files/per_marker_sorted"
split_AS = c('with_areashape_gprofiler', 'without_areashape_gprofiler')
file_name = function(marker_file, aspect) {
split_name = stringr::str_split(marker_file, "_")[[1]]
file_name = paste(split_name[1], split_name[3], 'unordered_enrichment', aspect, sep = "_")
file_name = paste(file_name, '.xlsx', sep = "")
return(file_name)
}
cc_gmt = gprofiler2::upload_GMT_file('C:/Users/peree/OneDrive/Desktop/CompBio_Code/fun_enrich_files/mapping_files/go_slim_c_20210430.gmt')
bp_gmt = gprofiler2::upload_GMT_file('C:/Users/peree/OneDrive/Desktop/CompBio_Code/fun_enrich_files/mapping_files/go_slim_p_20210430.gmt')
gost_enrich = function(go_standard, aspect) {
for (AS in split_AS) {
AS_path = paste(DIRECTORY, "/", AS, sep = "")
markers = list.files(AS_path)
setwd(paste(DIRECTORY, "/outputs_slim/", AS, sep = ""))
for (marker in markers) {
marker_path = paste(AS_path, "/", marker, sep = "")
marker_files = naturalsort::naturalsort(list.files(marker_path))
for (marker_file in marker_files) {
xlsx_file = file_name(marker_file, aspect)
file_path = paste(marker_path, "/", marker_file, sep = "")
marker_data = read.csv(file_path)
enrichment = gprofiler2::gost(query = marker_data$ORF,
organism = go_standard,
ordered_query = FALSE,
significant = TRUE,
user_threshold = 0.01,
correction_method = "fdr",
sources = c())$result
if (is.null(enrichment)) {next}
write.xlsx(enrichment, file = xlsx_file)
}
}
}
}
INPUT_DIRECTORY = "C:/Users/peree/OneDrive/Desktop/CompBio_Code/fun_enrich_files/per_marker_sorted"
OUTPUT_DIRECTORY = "C:/Users/peree/OneDrive/Desktop/CompBio_Code/fun_enrich_files/per_marker_unordered"
gost_enrich = function(go_standard, aspect) {
for (AS in split_AS) {
AS_path = paste(INPUT_DIRECTORY, "/", AS, sep = "")
markers = list.files(AS_path)
setwd(paste(OUTPUT_DIRECTORY, "/outputs_slim/", AS, sep = ""))
for (marker in markers) {
marker_path = paste(AS_path, "/", marker, sep = "")
marker_files = naturalsort::naturalsort(list.files(marker_path))
for (marker_file in marker_files) {
xlsx_file = file_name(marker_file, aspect)
file_path = paste(marker_path, "/", marker_file, sep = "")
marker_data = read.csv(file_path)
enrichment = gprofiler2::gost(query = marker_data$ORF,
organism = go_standard,
ordered_query = FALSE,
significant = TRUE,
user_threshold = 0.01,
correction_method = "fdr",
sources = c())$result
if (is.null(enrichment)) {next}
write.xlsx(enrichment, file = xlsx_file)
}
}
}
}
gost_enrich(cc_gmt, 'cc')
gost_enrich(bp_gmt, 'bp')
split_AS = c('with_areashape', 'without_areashape')
gost_enrich = function(go_standard, aspect) {
for (AS in split_AS) {
AS_path = paste(INPUT_DIRECTORY, "/", AS, sep = "")
markers = list.files(AS_path)
setwd(paste(OUTPUT_DIRECTORY, "/outputs_slim/", AS, sep = ""))
for (marker in markers) {
marker_path = paste(AS_path, "/", marker, sep = "")
marker_files = naturalsort::naturalsort(list.files(marker_path))
for (marker_file in marker_files) {
xlsx_file = file_name(marker_file, aspect)
file_path = paste(marker_path, "/", marker_file, sep = "")
marker_data = read.csv(file_path)
enrichment = gprofiler2::gost(query = marker_data$ORF,
organism = go_standard,
ordered_query = FALSE,
significant = TRUE,
user_threshold = 0.01,
correction_method = "fdr",
sources = c())$result
if (is.null(enrichment)) {next}
write.xlsx(enrichment, file = xlsx_file)
}
}
}
}
gost_enrich(cc_gmt, 'cc')
gost_enrich(bp_gmt, 'bp')
